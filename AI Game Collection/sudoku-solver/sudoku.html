<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fast Sudoku Solver</title>
<style>
body{font-family:sans-serif;background:#071427;color:#e6eef8;display:flex;gap:24px;padding:24px}
#board{display:grid;grid-template-columns:repeat(9,40px);gap:2px;background:#0b1220;padding:8px;border-radius:8px}
.cell{width:40px;height:40px;text-align:center;font-size:20px;background:#081826;color:#dbeafe;border:none;outline:none}
.given{background:#18324a;font-weight:700;color:#fff}
.ai-filled{color:#22c55e}
.thick-right{border-right:3px solid #0f1724}
.thick-bottom{border-bottom:3px solid #0f1724}
.controls{display:flex;flex-direction:column;gap:10px;width:320px}
button{padding:8px 10px;border-radius:8px;border:0;background:#0b1b2b;color:#dff3e8;cursor:pointer}
.row{display:flex;gap:8px}
.muted{color:#98a8ba;font-size:13px}
</style>
</head>
<body>
<div>
  <header>
    <h2 style="margin:0">Sudoku — Fast AI Solver</h2>
    <div class="muted">Enter digits (1–9). AI fills fast with animation.</div>
  </header>
  <div id="board"></div>
</div>

<div class="controls">
  <div class="row">
    <button id="btnLoad">Load Example</button>
    <button id="btnClear">Clear</button>
  </div>
  <div class="row">
    <button id="btnValidate">Validate</button>
    <button id="btnHint">Hint (one safe)</button>
  </div>
  <div class="row">
    <button id="btnFastSolve">Fast Solve</button>
    <button id="btnLoadAnswer">Load Answer</button>
  </div>
  <div id="status" class="muted">Status: idle</div>
</div>

<script>
const boardDiv = document.getElementById("board");
const cells = [];
for(let r=0;r<9;r++){
  for(let c=0;c<9;c++){
    const inp=document.createElement("input");
    inp.maxLength=1; inp.className="cell";
    if((c+1)%3===0 && c!==8) inp.classList.add("thick-right");
    if((r+1)%3===0 && r!==8) inp.classList.add("thick-bottom");
    inp.id=`cell-${r}-${c}`;
    inp.addEventListener("input",()=>{ if(inp.value!==""){if(!/^[1-9]$/.test(inp.value)) inp.value=""; }});
    boardDiv.appendChild(inp);
    cells.push(inp);
  }
}

function readBoard(){
  const grid=[];
  for(let r=0;r<9;r++){
    grid[r]=[];
    for(let c=0;c<9;c++){
      const v=document.getElementById(`cell-${r}-${c}`).value;
      grid[r][c]=v?parseInt(v):0;
    }
  }
  return grid;
}

function writeCell(r,c,val,given=false,aiFilled=false){
  const el=document.getElementById(`cell-${r}-${c}`);
  el.value=val||"";
  el.classList.toggle("given",given);
  el.classList.toggle("ai-filled",aiFilled);
}

function clearBoard(){
  for(let r=0;r<9;r++) for(let c=0;c<9;c++) writeCell(r,c,0,false,false);
  setStatus("Cleared");
}

function valid(grid,r,c,val){
  for(let i=0;i<9;i++){
    if(i!==c && grid[r][i]===val) return false;
    if(i!==r && grid[i][c]===val) return false;
  }
  const br=Math.floor(r/3)*3, bc=Math.floor(c/3)*3;
  for(let i=br;i<br+3;i++) for(let j=bc;j<bc+3;j++) if((i!==r || j!==c) && grid[i][j]===val) return false;
  return true;
}

function isValidGrid(grid){
  for(let r=0;r<9;r++) for(let c=0;c<9;c++){
    const v=grid[r][c];
    if(v!==0 && !valid(grid,r,c,v)) return false;
  }
  return true;
}

// backtracking solver
function solve(grid){
  for(let r=0;r<9;r++){
    for(let c=0;c<9;c++){
      if(grid[r][c]===0){
        for(let val=1;val<=9;val++){
          if(valid(grid,r,c,val)){
            grid[r][c]=val;
            if(solve(grid)) return true;
            grid[r][c]=0;
          }
        }
        return false;
      }
    }
  }
  return true;
}

// generate random puzzle example
function loadExample(){
  const examples=[
    [[0,0,0,2,6,0,7,0,1],[6,8,0,0,7,0,0,9,0],[1,9,0,0,0,4,5,0,0],[8,2,0,1,0,0,0,4,0],[0,0,4,6,0,2,9,0,0],[0,5,0,0,0,3,0,2,8],[0,0,9,3,0,0,0,7,4],[0,4,0,0,5,0,0,3,6],[7,0,3,0,1,8,0,0,0]],
    [[0,0,0,0,0,0,2,0,0],[0,8,0,0,0,7,0,9,0],[6,0,2,0,0,0,5,0,0],[0,7,0,0,6,0,0,0,0],[0,0,0,9,0,1,0,0,0],[0,0,0,0,2,0,0,4,0],[0,0,5,0,0,0,6,0,3],[0,9,0,4,0,0,0,7,0],[0,0,6,0,0,0,0,0,0]]
  ];
  const puzzle=examples[Math.floor(Math.random()*examples.length)];
  for(let r=0;r<9;r++) for(let c=0;c<9;c++) writeCell(r,c,puzzle[r][c],puzzle[r][c]!==0,false);
  setStatus("Loaded example");
}

function hint(){
  const grid=readBoard();
  for(let r=0;r<9;r++){
    for(let c=0;c<9;c++){
      if(grid[r][c]===0){
        for(let v=1;v<=9;v++){
          if(valid(grid,r,c,v)){
            writeCell(r,c,v,false,true);
            setStatus(`Hint: set ${r+1},${c+1} -> ${v}`);
            return;
          }
        }
      }
    }
  }
  setStatus("No hint available");
}

function fastSolveAnimation(){
  const grid=readBoard();
  const solution=JSON.parse(JSON.stringify(grid));
  solve(solution);
  let idx=0;
  const flat=[];
  for(let r=0;r<9;r++) for(let c=0;c<9;c++) if(grid[r][c]===0) flat.push([r,c]);
  setStatus("Fast solving...");
  const interval=setInterval(()=>{
    if(idx>=flat.length){ clearInterval(interval); setStatus("AI solved"); return; }
    const [r,c]=flat[idx++];
    writeCell(r,c,solution[r][c],false,true);
  },10); // adjust 10ms per cell ~1s for all
}

function loadAnswer(){
  const grid=readBoard();
  const solution=JSON.parse(JSON.stringify(grid));
  solve(solution);
  for(let r=0;r<9;r++) for(let c=0;c<9;c++) writeCell(r,c,solution[r][c],false,true);
  setStatus("Answer loaded");
}

function validateBoard(){
  const grid=readBoard();
  for(let r=0;r<9;r++) for(let c=0;c<9;c++) if(grid[r][c]===0){ setStatus("Cannot validate: board incomplete"); return; }
  const ok=isValidGrid(grid);
  setStatus(ok?"Board valid":"Board invalid");
}

function setStatus(text){ document.getElementById("status").innerText="Status: "+text; }

// button events
document.getElementById("btnLoad").addEventListener("click",loadExample);
document.getElementById("btnClear").addEventListener("click",clearBoard);
document.getElementById("btnValidate").addEventListener("click",validateBoard);
document.getElementById("btnHint").addEventListener("click",hint);
document.getElementById("btnFastSolve").addEventListener("click",fastSolveAnimation);
document.getElementById("btnLoadAnswer").addEventListener("click",loadAnswer);
</script>
</body>
</html>
